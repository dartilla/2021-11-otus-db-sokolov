# 02 Компоненты современной СУБД

## Цель
Научиться применять индексы в реальном проекте

## Описание задания
Добавляем в модель данных дополнительные индексы и ограничения.
* Проводим анализ возможных запросов/отчетов/поиска данных.
* Предполагаем возможную кардинальность поля.
* Создаем дополнительные индексы - простые или композитные.
* На каждый индекс пишем краткое описание зачем он нужен (почему по этому полю\полям).
* Думаем какие логические ограничения в БД нужно добавить - например какие поля должны быть уникальны, 
в какие нужно добавить условия, чтобы не нарушить бизнес логику.  
Пример - нельзя провести операцию по переводу средств на отрицательную сумму.

Создаем ограничения по выбранным полям.

## Что было сделано
Т.к. liquibase не формирует документацию для constraints и indexes, теперь документацию на БД генерируем посредством
[SchemaSpy](https://github.com/schemaspy/schemaspy)  
Теперь документация создается при сборке в `target/dbDoc`.
На всякий случай прикладываю ее архивом в `docs/dbDoc.7z`

### Добавлены ограничения
* `add constraint price_is_not_negative check ( price >= 0 )` - цена должна быть неотрицательна на таблицы `price` и `order_item`
* `add constraint amount_is_more_than_zero check ( amount > 0 )` - количество должно быть больше 0 на таблицы `price` и `order_item`

### Добавлены индексы
* `create index idx_01_orders on orders (creation_date);` - используется для выборки заказов за период времени 
(ежедневная/недельная отчетность). Возможно по этому полю надо будет сделать partitioning таблицы
* `create index idx_01_price on price (product_id, price);` - используется для выбора наилучшей цены (и поставщика 
соответственно) для товара 

